<!DOCTYPE html>
<html lang="km">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>QC Flash Cards</title>

    <!-- Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Battambang:wght@400;700&family=Orbitron:wght@700;900&family=DM+Sans:wght@400;500;600;700&display=swap" rel="stylesheet">

    <style>
        /* â”€â”€â”€ Design Tokens â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
        :root {
            --bg:       #070b1a;
            --surface:  #0f1630;
            --card:     #141d38;
            --border:   #1e2d52;
            --primary:  #4f8ef7;
            --accent:   #f4c430;
            --success:  #22d472;
            --danger:   #ff4d6d;
            --text:     #e8eaf6;
            --muted:    #7b89b8;
            --radius:   20px;
            --shadow:   0 24px 60px rgba(0,0,0,0.5);
        }

        /* â”€â”€â”€ Reset & Base â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
        *, *::before, *::after {
            margin: 0; padding: 0;
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
        }
        html, body {
            height: 100%;
            font-family: 'DM Sans', 'Battambang', sans-serif;
        }
        body {
            background: var(--bg);
            display: flex;
            justify-content: center;
            align-items: flex-start;
            min-height: 100vh;
            padding: 20px 15px 40px;
            overflow-x: hidden;
        }

        /* â”€â”€â”€ Animated Background â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
        body::before {
            content: '';
            position: fixed; inset: 0;
            background:
                radial-gradient(ellipse 60% 40% at 20% 10%, rgba(79,142,247,0.12) 0%, transparent 60%),
                radial-gradient(ellipse 50% 40% at 80% 80%, rgba(244,196,48,0.07) 0%, transparent 60%);
            pointer-events: none;
            z-index: 0;
        }

        /* â”€â”€â”€ Container â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
        .wrap {
            position: relative;
            z-index: 1;
            width: 100%;
            max-width: 460px;
            display: flex;
            flex-direction: column;
            gap: 0;
        }

        /* â”€â”€â”€ Header Brand â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
        .brand-header {
            text-align: center;
            padding: 28px 20px 20px;
        }
        .brand-badge {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            background: rgba(79,142,247,0.12);
            border: 1px solid rgba(79,142,247,0.3);
            border-radius: 100px;
            padding: 6px 16px;
            font-size: 11px;
            font-weight: 700;
            letter-spacing: 2px;
            color: var(--primary);
            text-transform: uppercase;
            margin-bottom: 14px;
        }
        .brand-title {
            font-family: 'Orbitron', sans-serif;
            font-size: 26px;
            font-weight: 900;
            color: var(--text);
            letter-spacing: 1px;
            line-height: 1.2;
        }
        .brand-title span {
            color: var(--accent);
        }
        .brand-sub {
            font-family: 'Battambang', sans-serif;
            font-size: 14px;
            color: var(--muted);
            margin-top: 6px;
        }

        /* â”€â”€â”€ Card â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
        .card {
            background: var(--card);
            border: 1px solid var(--border);
            border-radius: var(--radius);
            padding: 28px 24px;
            box-shadow: var(--shadow);
        }

        /* â”€â”€â”€ Flash Card Screen â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
        .progress-wrap {
            margin-bottom: 20px;
        }
        .progress-meta {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 8px;
        }
        .progress-label {
            font-family: 'Battambang', sans-serif;
            font-size: 12px;
            color: var(--muted);
        }
        .progress-count {
            font-family: 'Orbitron', sans-serif;
            font-size: 12px;
            color: var(--primary);
            font-weight: 700;
        }
        .progress-track {
            width: 100%;
            height: 6px;
            background: var(--surface);
            border-radius: 100px;
            overflow: hidden;
        }
        .progress-fill {
            height: 100%;
            width: 0%;
            border-radius: 100px;
            background: linear-gradient(90deg, var(--primary), var(--accent));
            transition: width 0.4s cubic-bezier(0.4,0,0.2,1);
        }

        /* â”€â”€â”€ Flash Card Container â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
        .flashcard-container {
            perspective: 1000px;
            margin-bottom: 24px;
            min-height: 420px;
        }

        .flashcard {
            position: relative;
            width: 100%;
            height: 420px;
            transform-style: preserve-3d;
            transition: transform 0.6s cubic-bezier(0.4, 0.0, 0.2, 1);
        }

        .flashcard.flipped {
            transform: rotateY(180deg);
        }

        .card-face {
            position: absolute;
            width: 100%;
            height: 100%;
            backface-visibility: hidden;
            background: var(--surface);
            border: 2px solid var(--border);
            border-radius: 20px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 30px;
            box-shadow: 0 8px 32px rgba(0,0,0,0.3);
        }

        .card-front {
            z-index: 2;
        }

        .card-back {
            transform: rotateY(180deg);
            background: linear-gradient(135deg, var(--surface) 0%, #0a0e1c 100%);
        }

        /* â”€â”€â”€ Card Content â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
        .card-label {
            position: absolute;
            top: 16px;
            left: 16px;
            background: rgba(79,142,247,0.15);
            border: 1px solid rgba(79,142,247,0.3);
            border-radius: 100px;
            padding: 4px 12px;
            font-size: 10px;
            font-weight: 700;
            letter-spacing: 1.5px;
            color: var(--primary);
            text-transform: uppercase;
        }

        .card-back .card-label {
            background: rgba(244,196,48,0.15);
            border-color: rgba(244,196,48,0.3);
            color: var(--accent);
        }

        .chinese-display {
            font-size: 72px;
            font-weight: 900;
            color: var(--text);
            margin-bottom: 20px;
            line-height: 1;
            text-shadow: 0 4px 12px rgba(79,142,247,0.3);
        }

        .khmer-display {
            font-family: 'Battambang', sans-serif;
            font-size: 28px;
            font-weight: 700;
            color: var(--accent);
            margin-bottom: 20px;
            text-align: center;
            line-height: 1.4;
        }

        .image-display {
            width: 100%;
            max-height: 200px;
            object-fit: contain;
            border-radius: 12px;
            margin-top: 16px;
            border: 1px solid var(--border);
        }

        /* â”€â”€â”€ Flip Button (NEW) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
        .flip-btn {
            position: absolute;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            padding: 12px 28px;
            background: linear-gradient(135deg, var(--primary) 0%, #6fa8ff 100%);
            border: none;
            border-radius: 100px;
            font-family: 'Battambang', sans-serif;
            font-size: 14px;
            font-weight: 700;
            color: #fff;
            cursor: pointer;
            box-shadow: 0 6px 20px rgba(79,142,247,0.4);
            transition: all 0.2s;
            display: flex;
            align-items: center;
            gap: 8px;
            z-index: 10;
        }

        .flip-btn:hover {
            box-shadow: 0 8px 24px rgba(79,142,247,0.5);
            transform: translateX(-50%) scale(1.05);
        }

        .flip-btn:active {
            transform: translateX(-50%) scale(0.95);
        }

        .flip-icon {
            font-size: 18px;
            animation: flip-hint 2s infinite;
        }

        @keyframes flip-hint {
            0%, 100% { transform: rotateY(0deg); }
            50% { transform: rotateY(180deg); }
        }

        /* â”€â”€â”€ Audio Controls â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
        .audio-controls {
            display: flex;
            gap: 12px;
            margin-bottom: 20px;
            justify-content: center;
        }

        .speak-btn {
            width: 64px;
            height: 64px;
            background: rgba(79,142,247,0.1);
            border: 2px solid rgba(79,142,247,0.35);
            border-radius: 16px;
            cursor: pointer;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            gap: 6px;
            transition: all 0.2s;
        }

        .speak-btn:active {
            background: rgba(79,142,247,0.25);
            transform: scale(0.93);
        }

        .speak-btn.speaking {
            background: rgba(79,142,247,0.2);
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(79,142,247,0.18);
        }

        .sp-icon {
            font-size: 28px;
        }

        .wave-bars {
            display: flex;
            align-items: center;
            gap: 2px;
            height: 12px;
        }

        .wave-bars span {
            display: block;
            width: 3px;
            border-radius: 3px;
            background: var(--primary);
            height: 4px;
        }

        .speak-btn.speaking .wave-bars span:nth-child(1) { animation: bar 0.7s 0.0s ease-in-out infinite; }
        .speak-btn.speaking .wave-bars span:nth-child(2) { animation: bar 0.7s 0.1s ease-in-out infinite; }
        .speak-btn.speaking .wave-bars span:nth-child(3) { animation: bar 0.7s 0.2s ease-in-out infinite; }
        .speak-btn.speaking .wave-bars span:nth-child(4) { animation: bar 0.7s 0.3s ease-in-out infinite; }
        .speak-btn.speaking .wave-bars span:nth-child(5) { animation: bar 0.7s 0.15s ease-in-out infinite; }

        @keyframes bar {
            0%, 100% { height: 3px; }
            50% { height: 12px; }
        }

        .speed-row {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }

        .speed-lbl {
            font-family: 'Battambang', sans-serif;
            font-size: 11px;
            color: var(--muted);
        }

        .speed-toggle {
            display: flex;
            background: var(--surface);
            border: 1px solid var(--border);
            border-radius: 100px;
            overflow: hidden;
        }

        .speed-toggle button {
            padding: 4px 10px;
            border: none;
            background: transparent;
            cursor: pointer;
            font-family: 'Orbitron', sans-serif;
            font-size: 10px;
            font-weight: 700;
            color: var(--muted);
            transition: all 0.15s;
        }

        .speed-toggle button.active {
            background: var(--primary);
            color: #fff;
        }

        /* â”€â”€â”€ Navigation Buttons â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
        .nav-buttons {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 12px;
            margin-bottom: 16px;
        }

        .btn {
            padding: 14px;
            border: 2px solid var(--border);
            border-radius: 14px;
            cursor: pointer;
            font-family: 'Battambang', sans-serif;
            font-size: 15px;
            font-weight: 700;
            transition: all 0.2s;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }

        .btn-prev {
            background: var(--surface);
            color: var(--text);
        }

        .btn-prev:hover:not(:disabled) {
            border-color: var(--primary);
            background: rgba(79,142,247,0.08);
        }

        .btn-next {
            background: linear-gradient(135deg, var(--primary) 0%, #6fa8ff 100%);
            color: #fff;
            border-color: var(--primary);
            box-shadow: 0 6px 20px rgba(79,142,247,0.3);
        }

        .btn-next:hover:not(:disabled) {
            box-shadow: 0 8px 24px rgba(79,142,247,0.4);
        }

        .btn:active:not(:disabled) {
            transform: scale(0.96);
        }

        .btn:disabled {
            opacity: 0.4;
            cursor: not-allowed;
        }

        /* â”€â”€â”€ Action Buttons â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
        .action-buttons {
            display: flex;
            gap: 10px;
        }

        .btn-action {
            flex: 1;
            padding: 12px;
            border: 1.5px solid var(--border);
            border-radius: 12px;
            background: var(--surface);
            color: var(--text);
            font-family: 'Battambang', sans-serif;
            font-size: 13px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 6px;
        }

        .btn-action:hover {
            border-color: var(--primary);
            background: rgba(79,142,247,0.08);
        }

        .btn-action:active {
            transform: scale(0.96);
        }

        /* â”€â”€â”€ Footer â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
        .footer {
            text-align: center;
            padding: 18px 0 0;
            font-size: 11px;
            color: rgba(123,137,184,0.5);
            letter-spacing: 0.5px;
        }

        /* â”€â”€â”€ Animations â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
        .fade-in {
            animation: fadeIn 0.35s ease both;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .slide-in {
            animation: slideIn 0.4s cubic-bezier(0.4, 0.0, 0.2, 1) both;
        }

        @keyframes slideIn {
            from { opacity: 0; transform: translateX(30px); }
            to { opacity: 1; transform: translateX(0); }
        }
    </style>
</head>
<body>
<div class="wrap">

    <!-- â”€â”€ Brand Header â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ -->
    <div class="brand-header">
        <div class="brand-badge">ğŸ“š FLASH CARDS</div>
        <div class="brand-title">QC<span>LEARN</span></div>
        <div class="brand-sub">ášáŸ€á“á–á¶á€áŸ’á™ QC á‡á¶á˜á½á™ Flash Cards</div>
    </div>

    <!-- â”€â”€ Main Card â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ -->
    <div class="card fade-in">
        
        <!-- Progress -->
        <div class="progress-wrap">
            <div class="progress-meta">
                <span class="progress-label">áœáŒáŸ’áá“á—á¶á–</span>
                <span class="progress-count" id="progressCount">1 / 49</span>
            </div>
            <div class="progress-track">
                <div class="progress-fill" id="progressFill"></div>
            </div>
        </div>

        <!-- Audio Controls -->
        <div class="audio-controls">
            <button class="speak-btn" id="speakBtn" onclick="playVoice()">
                <span class="sp-icon">ğŸ”Š</span>
                <div class="wave-bars">
                    <span></span><span></span><span></span><span></span><span></span>
                </div>
            </button>
        </div>

        <div class="speed-row">
            <span class="speed-lbl">á›áŸ’á”á¿á“:</span>
            <div class="speed-toggle">
                <button class="active" onclick="setSpeed(1.0, this)">1Ã—</button>
                <button onclick="setSpeed(0.65, this)">0.6Ã—</button>
                <button onclick="setSpeed(0.45, this)">0.4Ã—</button>
            </div>
        </div>

        <!-- Flash Card -->
        <div class="flashcard-container">
            <div class="flashcard" id="flashcard">
                <!-- Front -->
                <div class="card-face card-front">
                    <div class="card-label">ä¸­æ–‡</div>
                    <div class="chinese-display" id="chineseText">èµ·æ³¡</div>
                    <button class="flip-btn" onclick="flipCard()">
                        <span class="flip-icon">ğŸ”„</span>
                        <span>á˜á¾á›á€á¶ášá”á€á”áŸ’ášáŸ‚</span>
                    </button>
                </div>
                <!-- Back -->
                <div class="card-face card-back">
                    <div class="card-label">á—á¶áŸá¶ááŸ’á˜áŸ‚áš</div>
                    <div class="khmer-display" id="khmerText">á–á„ / á…á¼á›ááŸ’á™á›áŸ‹</div>
                    <img class="image-display" id="cardImage" src="" alt="" style="display:none;">
                    <button class="flip-btn" onclick="flipCard()">
                        <span class="flip-icon">ğŸ”„</span>
                        <span>ááŸ’ášá¡á”áŸ‹á€áŸ’ášáŸ„á™</span>
                    </button>
                </div>
            </div>
        </div>

        <!-- Navigation -->
        <div class="nav-buttons">
            <button class="btn btn-prev" id="prevBtn" onclick="prevCard()">
                â† á˜á»á“
            </button>
            <button class="btn btn-next" id="nextBtn" onclick="nextCard()">
                á”á“áŸ’á‘á¶á”áŸ‹ â†’
            </button>
        </div>

        <!-- Actions -->
        <div class="action-buttons">
            <button class="btn-action" onclick="shuffleCards()">
                ğŸ”€ á…áŸ’ášá”á›áŸ‹
            </button>
            <button class="btn-action" onclick="resetProgress()">
                â†» á…á¶á”áŸ‹á•áŸ’áá¾á˜á¡á¾á„áœá·á‰
            </button>
        </div>

    </div>

    <div class="footer">Â© QC Flash Cards &nbsp;Â·&nbsp; Powered by AI</div>
</div>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• LOGIC â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<script>
/* â”€â”€ Database â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
const database = [
    { cn:"èµ·æ³¡",       km:"á–á„ / á…á¼á›ááŸ’á™á›áŸ‹",          img:"qipao.jpg" },
    { cn:"æ ‡çº¸ä¸è‰¯",   km:"ááŸ‚á˜á˜á·á“á›áŸ’á¢",               img:"biaozhibuliang.jpg" },
    { cn:"ä¿®è¡¥ç—•",     km:"áŸáŸ’á“á¶á˜á‡á½áŸá‡á»á›",             img:"xiubuhen.jpg" },
    { cn:"æ‚è´¨",       km:"á’á¼á›á¸ / á€áŸ†á‘áŸá…á€áŸ†á‘á¸",        img:"zhazhi.jpg" },
    { cn:"è„æ±¡",       km:"á”áŸ’ášá¡á¶á€áŸ‹",                  img:"zangwu.jpg" },
    { cn:"æ ‡çº¸ä½ç½®ä¸å¯¹",km:"á”á·á‘ááŸ‚á˜áá»áŸá‘á¸áá¶áŸ†á„",        img:"biaozhiweizhibudui.jpg" },
    { cn:"æ ‡çº¸ä¸å¯¹ç§°", km:"á”á·á‘ááŸ‚á˜á˜á·á“áŸáŸ’á˜á¾á‚áŸ’á“á¶",       img:"biaozhibuduiceng.jpg" },
    { cn:"é›¾é¢",       km:"áŸáŸ’ášá¢á¶á”áŸ‹",                  img:"wumian.jpg" },
    { cn:"æ©˜çš®",       km:"áŸáŸ†á”á€á€áŸ’ášá¼á…",               img:"jupi.jpg" },
    { cn:"é’ˆå­”",       km:"ášá“áŸ’á’á˜áŸ’á‡á»á›",               img:"zhengkong.jpg" },
    { cn:"æ¶ˆå…‰ä¸è‰¯",   km:"á‘á¹á€ááŸ’á“á¶áŸ†áŸáŸ’ášá¢á¶á”áŸ‹á˜á·á“á›áŸ’á¢",  img:"xiaoguangbuliang.jpg" },
    { cn:"é˜²æ¼†ä¸è‰¯",   km:"á€á¶ášá–á¶ášá‘á¹á€ááŸ’á“á¶áŸ†á˜á·á“á”á¶á“á›áŸ’á¢", img:"fangqibuliang.jpg" },
    { cn:"å·¥å‚",       km:"ášáŸ„á„á…á€áŸ’áš",                 img:"gongchang.jpg" },
    { cn:"è½¦é—´",       km:"ášáŸ„á„á‡á¶á„ / á¢á¶á‚á¶áš",          img:"chejian.jpg" },
    { cn:"åŠå…¬å®¤",     km:"á€á¶ášá·á™á¶á›áŸá™",               img:"bangongshi.jpg" },
    { cn:"ç­é•¿",       km:"á”áŸ’ášá’á¶á“á€áŸ’ášá»á˜",             img:"banzhang.jpg" },
    { cn:"ç¿»è¯‘",       km:"á”á€á”áŸ’ášáŸ‚",                  img:"fanyi.jpg" },
    { cn:"æ³¨æ„å®‰å…¨",   km:"á”áŸ’ášá™áŸááŸ’á“áŸá»áœááŸ’áá·á—á¶á–",     img:"zhuyianquan.jpg" },
    { cn:"ä¸Šç­",       km:"á…á¼á›á’áŸ’áœá¾á€á¶áš",              img:"shangban.jpg" },
    { cn:"ä¸‹ç­",       km:"á…áŸá‰á–á¸á’áŸ’áœá¾á€á¶áš",            img:"xiaban.jpg" },
    { cn:"è¯·å‡",       km:"áŸá»áŸ†á…áŸ’á”á¶á”áŸ‹",               img:"qingjia.jpg" },
    { cn:"è½¦æ¶",       km:"áá½á€á„áŸ‹",                   img:"chejia.jpg" },
    { cn:"å‰å‰",       km:"á†áŸ’á–áŸ„áŸ‡á˜á»á (Fork)",        img:"qiancha.jpg" },
    { cn:"è½¦æŠŠ",       km:"áŠáŸƒá€á„áŸ‹",                   img:"cheba.jpg" },
    { cn:"è½¦åœˆ",       km:"ááŸ’á“á„á€á„áŸ‹",                 img:"chequan.jpg" },
    { cn:"å¤–èƒ",       km:"áŸáŸ†á”á€á€á„áŸ‹",                 img:"waitai.jpg" },
    { cn:"è„šè¸",       km:"áˆáŸ’á“á¶á“áŸ‹",                  img:"jiaota.jpg" },
    { cn:"é“¾æ¡",       km:"á…áŸ’ášáœá¶á€áŸ‹",                 img:"liantiao.jpg" },
    { cn:"åº§å«",       km:"á€áŸ‚á”",                      img:"zuodian.jpg" },
    { cn:"åˆ¹è½¦",       km:"á áŸ’áœáŸ’ášá¶áŸ†á„",               img:"shache.jpg" },
    { cn:"æµ‹é‡å€¼",     km:"áá˜áŸ’á›áŸƒáœá¶áŸáŸ‹á‡á¶á€áŸ‹áŸáŸ’ááŸ‚á„",    img:"celiangzhi.jpg" },
    { cn:"æ ‡å‡†å€¼",     km:"áá˜áŸ’á›áŸƒáŸáŸ’áá„áŸ‹áŠá¶",           img:"biaozhunzhi.jpg" },
    { cn:"ä¸Šé™",       km:"áŠáŸ‚á“á€áŸ†áááŸ‹ á›á¾",            img:"shangxian.jpg" },
    { cn:"ä¸‹é™",       km:"áŠáŸ‚á“á€áŸ†áááŸ‹ á€áŸ’ášáŸ„á˜",         img:"xiaxian.jpg" },
    { cn:"è¶‹åŠ¿å›¾",     km:"á€áŸ’ášá¶á”á“á·á“áŸ’á“á¶á€á¶áš",          img:"qushitu.jpg" },
    { cn:"åˆæ ¼",       km:"á‡á¶á”áŸ‹ (OK)",               img:"hege.jpg" },
    { cn:"ä¸åˆæ ¼",     km:"á’áŸ’á›á¶á€áŸ‹ (NG)",             img:"buhege.jpg" },
    { cn:"å¼€è£‚",       km:"á”áŸ’ášáŸáŸ‡ (Crack)",           img:"kailie.jpg" },
    { cn:"ç„Šç ´",       km:"á•áŸ’áŸá¶á’áŸ’á›á»áŸ‡",              img:"hanpo.jpg" },
    { cn:"æ¼ç„Š",       km:"á—áŸ’á›áŸá…á•áŸ’áŸá¶áš",             img:"louhan.jpg" },
    { cn:"é’ˆçœ¼",       km:"á—áŸ’á“áŸ‚á€á˜áŸ’á‡á»á›",             img:"zhenyan.jpg" },
    { cn:"å‡¹é™·",       km:"á€áŸ†á–á·á / á•á",             img:"aoxian.jpg" },
    { cn:"ç„Šé“åå¿ƒ",   km:"á•áŸ’áŸá¶ášáœáŸ€á…",               img:"handaobianxin.jpg" },
    { cn:"ç”µå‡»ä¼¤",     km:"á†áŸáŸ‡á˜áŸ‰á¶áŸ",               img:"dianjishang.jpg" },
    { cn:"å †ç„Š",       km:"á•áŸ’áŸá¶ášá‘á¼á› (Overlap)",     img:"duihan.jpg" },
    { cn:"å’¬è¾¹",       km:"áŸáŸŠá¸áŸá¶á…áŸ‹á”áŸ†á–á„áŸ‹",           img:"yaobian.jpg" },
    { cn:"é—´éš™",       km:"á…á“áŸ’á›áŸ„áŸ‡ / á á¾á”",           img:"jianxi.jpg" },
    { cn:"ç¢°åˆ®ä¼¤",     km:"á”áŸ‰áŸ‡á‘á„áŸ’á‚á·á… / á€áŸ„áŸ",       img:"pengguashang.jpg" },
    { cn:"ç„Šæ¸£",       km:"á€áŸ†á‘áŸá…á•áŸ’áŸá¶áš",             img:"hanzha.jpg" }
];

/* â”€â”€ State â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
let cards = [...database];
let currentIndex = 0;
let isFlipped = false;
let currentAudio = null;
let ttsSpeed = 1.0;

/* â”€â”€ Initialize â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
function init() {
    updateCard();
    updateProgress();
    updateNavButtons();
    unlockAudio();
}

/* â”€â”€ Update Card Display â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
function updateCard() {
    const card = cards[currentIndex];
    
    document.getElementById('chineseText').innerText = card.cn;
    document.getElementById('khmerText').innerText = card.km;
    
    const imgEl = document.getElementById('cardImage');
    if (card.img) {
        imgEl.src = card.img;
        imgEl.style.display = 'block';
    } else {
        imgEl.style.display = 'none';
    }
    
    // Reset flip state
    if (isFlipped) {
        document.getElementById('flashcard').classList.remove('flipped');
        isFlipped = false;
    }
    
    // Auto-play audio
    setTimeout(() => playVoice(), 300);
}

/* â”€â”€ Flip Card â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
function flipCard() {
    const flashcard = document.getElementById('flashcard');
    flashcard.classList.toggle('flipped');
    isFlipped = !isFlipped;
}

/* â”€â”€ Navigation â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
function nextCard() {
    if (currentIndex < cards.length - 1) {
        currentIndex++;
        updateCard();
        updateProgress();
        updateNavButtons();
        
        const flashcard = document.getElementById('flashcard');
        flashcard.classList.remove('slide-in');
        setTimeout(() => flashcard.classList.add('slide-in'), 10);
    }
}

function prevCard() {
    if (currentIndex > 0) {
        currentIndex--;
        updateCard();
        updateProgress();
        updateNavButtons();
        
        const flashcard = document.getElementById('flashcard');
        flashcard.classList.remove('slide-in');
        setTimeout(() => flashcard.classList.add('slide-in'), 10);
    }
}

function updateNavButtons() {
    document.getElementById('prevBtn').disabled = currentIndex === 0;
    document.getElementById('nextBtn').disabled = currentIndex === cards.length - 1;
}

/* â”€â”€ Progress â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
function updateProgress() {
    const progress = ((currentIndex + 1) / cards.length) * 100;
    document.getElementById('progressFill').style.width = progress + '%';
    document.getElementById('progressCount').innerText = (currentIndex + 1) + ' / ' + cards.length;
}

/* â”€â”€ Actions â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
function shuffleCards() {
    cards = [...database].sort(() => 0.5 - Math.random());
    currentIndex = 0;
    updateCard();
    updateProgress();
    updateNavButtons();
}

function resetProgress() {
    cards = [...database];
    currentIndex = 0;
    updateCard();
    updateProgress();
    updateNavButtons();
}

/* â”€â”€ Audio Engine â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
function setSpeed(val, btn) {
    ttsSpeed = val;
    document.querySelectorAll('.speed-toggle button')
        .forEach(b => b.classList.remove('active'));
    btn.classList.add('active');
}

function setSpeaking(on) {
    const btn = document.getElementById('speakBtn');
    if (!btn) return;
    if (on) btn.classList.add('speaking');
    else btn.classList.remove('speaking');
}

function playVoice() {
    if (currentAudio) {
        currentAudio.pause();
        currentAudio = null;
    }
    window.speechSynthesis.cancel();
    setSpeaking(false);

    const text = cards[currentIndex].cn;
    const speed = Math.max(0.35, Math.min(ttsSpeed, 1.0));

    const gttsSpeed = (speed * 0.9).toFixed(2);
    const url = `https://translate.google.com/translate_tts`
              + `?ie=UTF-8&q=${encodeURIComponent(text)}&tl=zh-CN`
              + `&client=gtx&ttsspeed=${gttsSpeed}`;

    const audio = new Audio(url);
    audio.playbackRate = 1.0;
    currentAudio = audio;

    setSpeaking(true);

    audio.onended = () => { setSpeaking(false); currentAudio = null; };
    audio.onerror = () => {
        setSpeaking(false);
        currentAudio = null;
        useSpeechSynthesis(text, speed);
    };

    audio.play().catch(() => {
        setSpeaking(false);
        currentAudio = null;
        useSpeechSynthesis(text, speed);
    });
}

function useSpeechSynthesis(text, speed) {
    window.speechSynthesis.cancel();
    setSpeaking(true);
    const u = new SpeechSynthesisUtterance(text);
    u.lang = 'zh-CN';
    u.rate = Math.max(0.3, speed * 0.85);

    const voices = window.speechSynthesis.getVoices();
    const cnVoice = voices.find(v =>
        v.lang === 'zh-CN' && /Google|Microsoft|Meijia|Ting-Ting/.test(v.name)
    ) || voices.find(v => v.lang === 'zh-CN')
      || voices.find(v => v.lang.startsWith('zh'));
    if (cnVoice) u.voice = cnVoice;

    u.onend = () => setSpeaking(false);
    u.onerror = () => setSpeaking(false);
    window.speechSynthesis.speak(u);
}

function unlockAudio() {
    try {
        const silence = new Audio("data:audio/wav;base64,UklGRiQAAABXQVZFZm10IBAAAAABAAEARKwAAIhYAQACABAAZGF0YQAAAAA=");
        silence.volume = 0;
        silence.play().catch(() => {});
    } catch(e) {}
    try {
        const u = new SpeechSynthesisUtterance(" ");
        u.volume = 0;
        window.speechSynthesis.speak(u);
    } catch(e) {}
    window.speechSynthesis.getVoices();
}

/* â”€â”€ Keyboard Support â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
document.addEventListener('keydown', e => {
    if (e.key === 'ArrowRight') nextCard();
    if (e.key === 'ArrowLeft') prevCard();
    if (e.key === ' ' || e.key === 'Enter') {
        e.preventDefault();
        flipCard();
    }
});

/* â”€â”€ Initialize App â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
init();
</script>
</body>
</html>
